(function(){"use strict";angular.module("fc.common").provider("authSvc",n);function n(){var n=this;n.loginUrl=null;n.signOutUrl=null;n.$get=t;t.$inject=["$http","$window"];function t(t,r){return{clearAuthData:e,getAuthData:u,getCurrentUser:o,isAdmin:s,isLoggedIn:a,isUser:i,login:c,setAuthData:f,signOut:l};function e(){r.sessionStorage.removeItem("auth")}function u(){return JSON.parse(r.sessionStorage.getItem("auth"))}function o(){var n=u();return n?n.user:null}function s(){var n=u();if(n&&!n.user){return false}return _.any(n.user.roles,function(n){return n.name==="Admin"})}function i(){var n=u();if(n&&!n.user){return false}return _.any(n.user.roles,function(n){return n.name==="Company"})}function a(){return Boolean(u())}function c(r){return t.post(n.loginUrl,r).success(function(n,t,r,e){var o=u()||{};o.token=n.token;o.user=n.user;f(o)}).error(function(n,t,r,u){e()})}function f(n){r.sessionStorage.setItem("auth",JSON.stringify(n))}function l(){return t.post(n.signOutUrl).success(function(n,t,r,u){e()}).error(function(n,t,r,u){e()})}}}})();